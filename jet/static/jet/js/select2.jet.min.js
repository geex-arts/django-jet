!function(t){t.fn.select2.amd.require(["select2/utils","select2/dropdown","select2/dropdown/attachBody","select2/dropdown/search","select2/dropdown/minimumResultsForSearch","select2/dropdown/closeOnSelect"],function(e,o,s,n,a,l){s.prototype._positionDropdown=function(){var e=t(window),o=this.$dropdown.hasClass("select2-dropdown--above"),s=this.$dropdown.hasClass("select2-dropdown--below"),n=null,a=(this.$container.position(),this.$container.offset());a.bottom=a.top+this.$container.outerHeight(!1);var l={height:this.$container.outerHeight(!1)};l.top=a.top,l.bottom=a.top+l.height;var r={height:this.$dropdown.outerHeight(!1)},i={top:e.scrollTop(),bottom:e.scrollTop()+e.height()},c=i.top<a.top-r.height,d=i.bottom>a.bottom+r.height,p={left:a.left,top:l.bottom};if(o||s||(n="below"),d||!c||o?!c&&d&&o&&(n="below"):n="above",("above"==n||o&&"below"!==n)&&(p.top=l.top-r.height),null!=n){this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+n),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+n);var h=this.$dropdown.find(".select2-search");"above"==n&&h.is(":first-child")?h.detach().appendTo(this.$dropdown):"below"==n&&h.is(":last-child")&&h.detach().prependTo(this.$dropdown)}this.$dropdownContainer.css(p)},s.prototype.render=function(e){var o=t("<span></span>"),s=e.call(this);return o.append(s),this.$dropdownContainer=o,this.$element.prop("multiple")?this.$dropdown.addClass("select2-multiple-dropdown"):this.$dropdown.removeClass("select2-multiple-dropdown"),o},o.prototype.render=function(){var e="";this.options.get("multiple")&&(e='<div class="select2-buttons"><a href="#" class="select2-buttons-button select2-buttons-button-select-all">'+django.gettext("select all")+'</a> <a href="#" class="select2-buttons-button select2-buttons-button-deselect-all">'+django.gettext("deselect all")+"</a></div>");var o=t('<span class="select2-dropdown">'+e+'<span class="select2-results"></span></span>'),s=this.$element;return o.find(".select2-buttons-button-select-all").on("click",function(e){e.preventDefault();var o=[];s.find("option").each(function(){o.push(t(this).val())}),s.select2("val",o),s.select2("close")}),o.find(".select2-buttons-button-deselect-all").on("click",function(t){t.preventDefault(),s.select2("val",""),s.select2("close")}),o.attr("dir",this.options.get("dir")),this.$dropdown=o,o};var r=e.Decorate(e.Decorate(o,n),s);r=e.Decorate(r,a),r=e.Decorate(r,l),t(document).on("select:init","select:not(.not_fancy)",function(){var e=t(this);if(!(e.parents(".empty-form").length>0)){var o={theme:"jet",dropdownAdapter:r};if(e.hasClass("ajax")){var s=e.data("content-type-id"),n=e.data("app-label"),a=e.data("model"),l=e.data("object-id"),i=100;o.ajax={dataType:"json",data:function(t){return{content_type:s,app_label:n,model:a,q:t.term,page:t.page,page_size:i,object_id:l}},processResults:function(t,e){if(t.error)return{};e.page=e.page||1;var o=e.page*i<t.total;return{results:t.items,pagination:{more:o}}}}}e.select2(o)}}),t(document).ready(function(){t("select:not(.not_fancy)").trigger("select:init")})})}(jet.jQuery);